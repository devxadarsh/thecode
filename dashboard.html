<div class="dashboard-container">
  <div class="container-fluid px-4 py-4">

    <!-- Dashboard Header -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h1 class="dashboard-title mb-0">
              <i class="fa fa-dashboard me-2"></i>
              Executive Dashboard
            </h1>
            <p class="text-muted mb-0">Real-time business insights and analytics</p>
          </div>
          <div class="text-end">
            <small class="text-muted">Last updated: {{ new Date() | date:'short' }}</small>
          </div>
        </div>
      </div>
    </div>

    <!-- Row 1: Financial Performance & Top Users -->
    <div class="row mb-4 equal-height-row">

      <!-- Financial Performance Section -->
      <div class="col-lg-6 mb-3">
        <div class="card h-100 shadow-sm">
          <div class="card-header bg-primary text-white">
            <h5 class="card-title mb-0">
              <i class="fa fa-line-chart me-2"></i>
              Financial Performance
            </h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-6 mb-3">
                <div class="metric-card bg-light p-3 rounded">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <h4 class="text-success mb-1">{{ financialData.revenue.value }}</h4>
                      <small class="text-muted">Revenue</small>
                    </div>
                    <div class="text-end">
                      <i class="fa {{ getTrendIcon(financialData.revenue.growth) }}"></i>
                      <small class="d-block">{{ financialData.revenue.growth }}</small>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="metric-card bg-light p-3 rounded">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <h4 class="text-info mb-1">{{ financialData.profit.value }}</h4>
                      <small class="text-muted">Profit</small>
                    </div>
                    <div class="text-end">
                      <i class="fa {{ getTrendIcon(financialData.profit.growth) }}"></i>
                      <small class="d-block">{{ financialData.profit.growth }}</small>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="metric-card bg-light p-3 rounded">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <h4 class="text-warning mb-1">{{ financialData.expenses.value }}</h4>
                      <small class="text-muted">Expenses</small>
                    </div>
                    <div class="text-end">
                      <i class="fa {{ getTrendIcon(financialData.expenses.growth) }}"></i>
                      <small class="d-block">{{ financialData.expenses.growth }}</small>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="metric-card bg-light p-3 rounded">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <h4 class="text-primary mb-1">{{ financialData.margin.value }}</h4>
                      <small class="text-muted">Profit Margin</small>
                    </div>
                    <div class="text-end">
                      <i class="fa {{ getTrendIcon(financialData.margin.growth) }}"></i>
                      <small class="d-block">{{ financialData.margin.growth }}</small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Revenue Trend Chart -->
            <div class="mt-3" style="height: 200px;">
              <canvas baseChart [datasets]="revenueTrendChartData" [labels]="revenueTrendChartLabels"
                [options]="revenueTrendChartOptions" [chartType]="revenueTrendChartType">
              </canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Top Users Section -->
      <div class="col-lg-6 mb-3">
        <div class="card h-100 shadow-sm">
          <div class="card-header bg-success text-white">
            <h5 class="card-title mb-0">
              <i class="fa fa-users me-2"></i>
              Top Users
            </h5>
          </div>
          <div class="card-body">
            <div class="row mb-3">
              <div class="col-6">
                <div class="metric-card bg-light p-3 rounded text-center">
                  <h4 class="text-success mb-1">{{ topUsers.length }}</h4>
                  <small class="text-muted">Active Users</small>
                </div>
              </div>
              <div class="col-6">
                <div class="metric-card bg-light p-3 rounded text-center">
                  <h4 class="text-info mb-1">$81K</h4>
                  <small class="text-muted">Total Revenue</small>
                </div>
              </div>
            </div>
            <div class="user-list">
              <div *ngFor="let user of topUsers"
                class="user-item d-flex align-items-center justify-content-between mb-3 p-3 bg-light rounded">
                <div class="d-flex align-items-center">
                  <div
                    class="user-avatar bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-3"
                    style="width: 40px; height: 40px;">
                    {{ user.name.charAt(0) }}{{ user.name.split(' ')[1]?.charAt(0) }}
                  </div>
                  <div>
                    <h6 class="mb-1">{{ user.name }}</h6>
                    <small class="text-muted">Activity: {{ user.activity }}%</small>
                  </div>
                </div>
                <div class="text-end">
                  <div class="text-success fw-bold">{{ user.revenue }}</div>
                  <small class="badge" [ngClass]="user.status === 'active' ? 'bg-success' : 'bg-secondary'">
                    {{ user.status }}
                  </small>
                </div>
              </div>
            </div>
            <!-- MOP Performance Chart -->
            <div class="mt-3" style="height: 200px;">
              <canvas baseChart [datasets]="mopPerformanceChartData" [labels]="mopPerformanceChartLabels"
                [options]="mopPerformanceChartOptions" [chartType]="mopPerformanceChartType"
                [legend]="mopPerformanceChartLegend">
              </canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Row 2: Risk & Health -->
    <div class="row mb-4 equal-height-row">

      <!-- Risk Assessment Section -->
      <div class="col-lg-6 mb-3">
        <div class="card h-100 shadow-sm">
          <div class="card-header bg-warning text-dark">
            <h5 class="card-title mb-0">
              <i class="fa fa-shield me-2"></i>
              Risk Assessment
            </h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-6 mb-3">
                <div class="risk-metric bg-light p-3 rounded">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <h5 class="text-{{ riskData.overall.color }} mb-1">{{ riskData.overall.level }}</h5>
                      <small class="text-muted">Overall Risk</small>
                    </div>
                    <div class="risk-score text-{{ riskData.overall.color }}">
                      <h4>{{ riskData.overall.score }}</h4>
                    </div>
                  </div>
                  <div class="progress mt-2" style="height: 8px;">
                    <div class="progress-bar bg-{{ riskData.overall.color }}" [style.width.%]="riskData.overall.score">
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="risk-metric bg-light p-3 rounded">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <h5 class="text-{{ riskData.financial.color }} mb-1">{{ riskData.financial.level }}</h5>
                      <small class="text-muted">Financial Risk</small>
                    </div>
                    <div class="risk-score text-{{ riskData.financial.color }}">
                      <h4>{{ riskData.financial.score }}</h4>
                    </div>
                  </div>
                  <div class="progress mt-2" style="height: 8px;">
                    <div class="progress-bar bg-{{ riskData.financial.color }}"
                      [style.width.%]="riskData.financial.score">
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="risk-metric bg-light p-3 rounded">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <h5 class="text-{{ riskData.operational.color }} mb-1">{{ riskData.operational.level }}</h5>
                      <small class="text-muted">Operational Risk</small>
                    </div>
                    <div class="risk-score text-{{ riskData.operational.color }}">
                      <h4>{{ riskData.operational.score }}</h4>
                    </div>
                  </div>
                  <div class="progress mt-2" style="height: 8px;">
                    <div class="progress-bar bg-{{ riskData.operational.color }}"
                      [style.width.%]="riskData.operational.score">
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="risk-metric bg-light p-3 rounded">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <h5 class="text-{{ riskData.compliance.color }} mb-1">{{ riskData.compliance.level }}</h5>
                      <small class="text-muted">Compliance Risk</small>
                    </div>
                    <div class="risk-score text-{{ riskData.compliance.color }}">
                      <h4>{{ riskData.compliance.score }}</h4>
                    </div>
                  </div>
                  <div class="progress mt-2" style="height: 8px;">
                    <div class="progress-bar bg-{{ riskData.compliance.color }}"
                      [style.width.%]="riskData.compliance.score">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Health Metrics Section -->
      <div class="col-lg-6 mb-3">
        <div class="card h-100 shadow-sm">
          <div class="card-header bg-info text-white">
            <h5 class="card-title mb-0">
              <i class="fa fa-heartbeat me-2"></i>
              System Health
            </h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-6 mb-3">
                <div class="health-metric bg-light p-3 rounded">
                  <div class="d-flex align-items-center">
                    <i class="fa {{ getStatusIcon(healthMetrics.systemHealth.status) }} fa-2x me-3"></i>
                    <div class="flex-grow-1">
                      <h6 class="mb-1">System Health</h6>
                      <div class="d-flex justify-content-between align-items-center">
                        <small class="text-muted">{{ healthMetrics.systemHealth.status }}</small>
                        <span class="text-{{ healthMetrics.systemHealth.color }} fw-bold">{{
                          healthMetrics.systemHealth.percentage }}%</span>
                      </div>
                      <div class="progress mt-2" style="height: 6px;">
                        <div class="progress-bar bg-{{ healthMetrics.systemHealth.color }}"
                          [style.width.%]="healthMetrics.systemHealth.percentage">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="health-metric bg-light p-3 rounded">
                  <div class="d-flex align-items-center">
                    <i class="fa {{ getStatusIcon(healthMetrics.performance.status) }} fa-2x me-3"></i>
                    <div class="flex-grow-1">
                      <h6 class="mb-1">Performance</h6>
                      <div class="d-flex justify-content-between align-items-center">
                        <small class="text-muted">{{ healthMetrics.performance.status }}</small>
                        <span class="text-{{ healthMetrics.performance.color }} fw-bold">{{
                          healthMetrics.performance.percentage }}%</span>
                      </div>
                      <div class="progress mt-2" style="height: 6px;">
                        <div class="progress-bar bg-{{ healthMetrics.performance.color }}"
                          [style.width.%]="healthMetrics.performance.percentage">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="health-metric bg-light p-3 rounded">
                  <div class="d-flex align-items-center">
                    <i class="fa {{ getStatusIcon(healthMetrics.availability.status) }} fa-2x me-3"></i>
                    <div class="flex-grow-1">
                      <h6 class="mb-1">Availability</h6>
                      <div class="d-flex justify-content-between align-items-center">
                        <small class="text-muted">{{ healthMetrics.availability.status }}</small>
                        <span class="text-{{ healthMetrics.availability.color }} fw-bold">{{
                          healthMetrics.availability.percentage }}%</span>
                      </div>
                      <div class="progress mt-2" style="height: 6px;">
                        <div class="progress-bar bg-{{ healthMetrics.availability.color }}"
                          [style.width.%]="healthMetrics.availability.percentage">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="health-metric bg-light p-3 rounded">
                  <div class="d-flex align-items-center">
                    <i class="fa {{ getStatusIcon(healthMetrics.security.status) }} fa-2x me-3"></i>
                    <div class="flex-grow-1">
                      <h6 class="mb-1">Security</h6>
                      <div class="d-flex justify-content-between align-items-center">
                        <small class="text-muted">{{ healthMetrics.security.status }}</small>
                        <span class="text-{{ healthMetrics.security.color }} fw-bold">{{
                          healthMetrics.security.percentage }}%</span>
                      </div>
                      <div class="progress mt-2" style="height: 6px;">
                        <div class="progress-bar bg-{{ healthMetrics.security.color }}"
                          [style.width.%]="healthMetrics.security.percentage">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Row 3: Issues (Single Section) -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="card shadow-sm">
          <div class="card-header bg-danger text-white">
            <h5 class="card-title mb-0">
              <i class="fa fa-exclamation-triangle me-2"></i>
              Issues & Alerts
            </h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-lg-3 col-md-6 mb-3">
                <div class="issue-card bg-light p-4 rounded text-center border-start border-5 border-danger">
                  <div class="issue-icon text-danger mb-2">
                    <i class="fa fa-times-circle fa-3x"></i>
                  </div>
                  <h3 class="text-danger mb-1">{{ issues.critical.count }}</h3>
                  <h6 class="text-muted mb-2">Critical Issues</h6>
                  <div class="d-flex justify-content-center align-items-center">
                    <i class="fa {{ getTrendIcon(issues.critical.trend) }} me-1"></i>
                    <small>{{ issues.critical.trend }}</small>
                  </div>
                </div>
              </div>
              <div class="col-lg-3 col-md-6 mb-3">
                <div class="issue-card bg-light p-4 rounded text-center border-start border-5 border-warning">
                  <div class="issue-icon text-warning mb-2">
                    <i class="fa fa-exclamation-triangle fa-3x"></i>
                  </div>
                  <h3 class="text-warning mb-1">{{ issues.high.count }}</h3>
                  <h6 class="text-muted mb-2">High Priority</h6>
                  <div class="d-flex justify-content-center align-items-center">
                    <i class="fa {{ getTrendIcon(issues.high.trend) }} me-1"></i>
                    <small>{{ issues.high.trend }}</small>
                  </div>
                </div>
              </div>
              <div class="col-lg-3 col-md-6 mb-3">
                <div class="issue-card bg-light p-4 rounded text-center border-start border-5 border-info">
                  <div class="issue-icon text-info mb-2">
                    <i class="fa fa-info-circle fa-3x"></i>
                  </div>
                  <h3 class="text-info mb-1">{{ issues.medium.count }}</h3>
                  <h6 class="text-muted mb-2">Medium Priority</h6>
                  <div class="d-flex justify-content-center align-items-center">
                    <i class="fa {{ getTrendIcon(issues.medium.trend) }} me-1"></i>
                    <small>{{ issues.medium.trend }}</small>
                  </div>
                </div>
              </div>
              <div class="col-lg-3 col-md-6 mb-3">
                <div class="issue-card bg-light p-4 rounded text-center border-start border-5 border-secondary">
                  <div class="issue-icon text-secondary mb-2">
                    <i class="fa fa-minus-circle fa-3x"></i>
                  </div>
                  <h3 class="text-secondary mb-1">{{ issues.low.count }}</h3>
                  <h6 class="text-muted mb-2">Low Priority</h6>
                  <div class="d-flex justify-content-center align-items-center">
                    <i class="fa {{ getTrendIcon(issues.low.trend) }} me-1"></i>
                    <small>{{ issues.low.trend }}</small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
